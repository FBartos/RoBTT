<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to RoBTT • RoBTT</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to RoBTT">
<meta property="og:description" content="RoBTT">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RoBTT</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Introduction_to_RoBTT.html">Introduction to RoBTT</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/FBartos/RoBTT/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Introduction_to_RoBTT_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to RoBTT</h1>
                        <h4 data-toc-skip class="author">Maximilian Maier &amp; František Bartoš</h4>
            
            <h4 data-toc-skip class="date">2023-03-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/FBartos/RoBTT/blob/HEAD/vignettes/Introduction_to_RoBTT.Rmd" class="external-link"><code>vignettes/Introduction_to_RoBTT.Rmd</code></a></small>
      <div class="hidden name"><code>Introduction_to_RoBTT.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction-and-example">Introduction and Example<a class="anchor" aria-label="anchor" href="#introduction-and-example"></a>
</h2>
<p>This vignette introduces the basic functionality of the RoBTT package using a classic example from Ronald Fishers Design of Experiments <span class="citation">(Fisher, 1971)</span>. Fisher illustrates the Student’s <span class="math inline">\(t\)</span>-test on an example of self fertilized and cross fertilized plants as coded by Darwin. In other words, one group of plants was fertilized by gametes (sex-cells) from the same individual (self), while the other group of plants was fertilized by gametes from the same species (cross). Darwin himself concludes:</p>
<p><em>I may premise that if we took by chance a dozen men belonging to two nations and measured them, it would I presume be very rash to form any judgment from such small number on their average heights. But the case is somewhat different with crossed and self-fertilized plants, as they were exactly the same age, were subjected from first to last to the same conditions, and were descended from the same parents.</em> p. 28 <span class="citation">(Fisher, 1971)</span>.</p>
<p>Not knowing much about statistics he gives his data to Francis Galton, who proceeds to order the plants by height as a method of statistical analysis and concludes:</p>
<p><em>The observations as I received them […] certainly have no prima facie appearance of regularity. But as soon as we arrange them in the order of their magnitudes […] the case is materially altered. We now see, with few exceptions, that the largest plant on the crossed side in each pot exceeds the largest plant on the self-fertilised side, that the second exceeds the second, the third the third, and so on. .</em> p. 29 <span class="citation">(Fisher, 1971)</span>.</p>
<p>Galton then forwarded the data to Fisher, who later analyzed it with a frequentist Student’s <span class="math inline">\(t\)</span>-test and states:</p>
<p><em>The observed value of <span class="math inline">\(t\)</span>, 2.148, thus just exceeds the 5 per cent point, and the experimental result may be judged significant, though barely so. .</em></p>
<p>We can load the included data with the code below</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fbartos.github.io/RoBTT/" class="external-link">RoBTT</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"fertilization"</span>, package <span class="op">=</span> <span class="st">"RoBTT"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fertilization</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Crossed   Self</span></span>
<span><span class="co">#&gt; 1  23.500 17.375</span></span>
<span><span class="co">#&gt; 2  12.000 20.375</span></span>
<span><span class="co">#&gt; 3  21.000 20.000</span></span>
<span><span class="co">#&gt; 4  22.000 20.000</span></span>
<span><span class="co">#&gt; 5  19.125 18.375</span></span>
<span><span class="co">#&gt; 6  21.500 18.625</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="equal-variance-t-test">Equal Variance t-test<a class="anchor" aria-label="anchor" href="#equal-variance-t-test"></a>
</h2>
<p>We reanalyze the data using a Bayesian equal variance <span class="math inline">\(t\)</span>-test as follows.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## fit equal variance t-test</span></span>
<span><span class="va">fit_01</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RoBTT.html">RoBTT</a></span><span class="op">(</span></span>
<span>  x1       <span class="op">=</span> <span class="va">fertilization</span><span class="op">$</span><span class="va">Self</span>,</span>
<span>  x2       <span class="op">=</span> <span class="va">fertilization</span><span class="op">$</span><span class="va">Crossed</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  prior_delta <span class="op">=</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span><span class="st">"cauchy"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  prior_rho   <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># this indicates no prior on the precision proportion -&gt; equal variance test</span></span>
<span>  likelihood  <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>  seed        <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We can retrieve a summary of the estimates with the code below. This function gives us the posterior mean and median estimate for the effect in terms of Cohen’s <span class="math inline">\(d\)</span> and 95% central credible interval. In addition, it shows the estimates for mean and variance in each of the groups.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get overall summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_01</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; RoBTT(x1 = fertilization$Self, x2 = fertilization$Crossed, prior_delta = prior("cauchy", </span></span>
<span><span class="co">#&gt;     list(0, 1/sqrt(2))), prior_rho = NULL, likelihood = "normal", </span></span>
<span><span class="co">#&gt;     parallel = TRUE, seed = 0)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Robust Bayesian t-test</span></span>
<span><span class="co">#&gt; Components summary:</span></span>
<span><span class="co">#&gt;        Models Prior prob. Post. prob. Inclusion BF</span></span>
<span><span class="co">#&gt; Effect    1/2       0.500       0.744        2.899</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model-averaged estimates:</span></span>
<span><span class="co">#&gt;        Mean Median 0.025 0.975</span></span>
<span><span class="co">#&gt; delta 0.543  0.551 0.000 1.434</span></span></code></pre></div>
<p>We can also look at the estimates for the individual models and retrieve their prior distributions. The Bayesian equal variance <span class="math inline">\(t\)</span>-test uses two models: One assuming absence of an effect (as indicated by prior <span class="math inline">\(\delta = \text{Spike}(0)\)</span>) assuming presence of an effect (as indicated by prior <span class="math inline">\(\delta = \text{Cauchy}(0, 0.71)\)</span>). Both models assume equal variances. The inclusion Bayes factor shows the evidence for the inclusion of the individual models. In this case the Bayes factor for model 2 (assuming the difference in mean) is equivalent to the Bayes factor for the presence of an effect.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get individual model summaries</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_01</span>, type <span class="op">=</span> <span class="st">"models"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; RoBTT(x1 = fertilization$Self, x2 = fertilization$Crossed, prior_delta = prior("cauchy", </span></span>
<span><span class="co">#&gt;     list(0, 1/sqrt(2))), prior_rho = NULL, likelihood = "normal", </span></span>
<span><span class="co">#&gt;     parallel = TRUE, seed = 0)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Robust Bayesian t-test</span></span>
<span><span class="co">#&gt; Models overview:</span></span>
<span><span class="co">#&gt;  Model Distribution   Prior delta   Prior prob. log(marglik) Post. prob.</span></span>
<span><span class="co">#&gt;      1       normal        Spike(0)       0.500       -76.82       0.256</span></span>
<span><span class="co">#&gt;      2       normal Cauchy(0, 0.71)       0.500       -75.76       0.744</span></span>
<span><span class="co">#&gt;  Inclusion BF</span></span>
<span><span class="co">#&gt;         0.345</span></span>
<span><span class="co">#&gt;         2.899</span></span></code></pre></div>
<p>Finally, we can use the <code>conditional = TRUE</code> argument to retrieve the estimates only for the models assuming an effect (i.e., without the spike).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_01</span>, conditional <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; RoBTT(x1 = fertilization$Self, x2 = fertilization$Crossed, prior_delta = prior("cauchy", </span></span>
<span><span class="co">#&gt;     list(0, 1/sqrt(2))), prior_rho = NULL, likelihood = "normal", </span></span>
<span><span class="co">#&gt;     parallel = TRUE, seed = 0)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Robust Bayesian t-test</span></span>
<span><span class="co">#&gt; Components summary:</span></span>
<span><span class="co">#&gt;        Models Prior prob. Post. prob. Inclusion BF</span></span>
<span><span class="co">#&gt; Effect    1/2       0.500       0.744        2.899</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model-averaged estimates:</span></span>
<span><span class="co">#&gt;        Mean Median 0.025 0.975</span></span>
<span><span class="co">#&gt; delta 0.543  0.551 0.000 1.434</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Conditional estimates:</span></span>
<span><span class="co">#&gt;        Mean Median 0.025 0.975</span></span>
<span><span class="co">#&gt; delta 0.732  0.721 0.032 1.503</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="unequal-variance-t-test">Unequal Variance t-test<a class="anchor" aria-label="anchor" href="#unequal-variance-t-test"></a>
</h2>
<p>We can also analyze the example using an unequal variance <span class="math inline">\(t\)</span>-test as follows.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## fit equal unvariance t-test</span></span>
<span></span>
<span><span class="va">fit_10</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RoBTT.html">RoBTT</a></span><span class="op">(</span></span>
<span>  x1       <span class="op">=</span> <span class="va">fertilization</span><span class="op">$</span><span class="va">Self</span>,</span>
<span>  x2       <span class="op">=</span> <span class="va">fertilization</span><span class="op">$</span><span class="va">Crossed</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  prior_delta    <span class="op">=</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span><span class="st">"cauchy"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  prior_rho      <span class="op">=</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span><span class="st">"beta"</span>,   <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>, <span class="co"># prior on precision proportion</span></span>
<span>  prior_rho_null <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># remove models assuming equal variance</span></span>
<span>  likelihood     <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>  seed           <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We again retrieve the summary; however, this time we also get a Bayes factor for unequal variances (heterogeneity) and an estimate for <span class="math inline">\(\rho\)</span> (the precision proportion).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_10</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; RoBTT(x1 = fertilization$Self, x2 = fertilization$Crossed, prior_delta = prior("cauchy", </span></span>
<span><span class="co">#&gt;     list(0, 1/sqrt(2))), prior_rho = prior("beta", list(3, 3)), </span></span>
<span><span class="co">#&gt;     prior_rho_null = NULL, likelihood = "normal", parallel = TRUE, </span></span>
<span><span class="co">#&gt;     seed = 0)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Robust Bayesian t-test</span></span>
<span><span class="co">#&gt; Components summary:</span></span>
<span><span class="co">#&gt;               Models Prior prob. Post. prob. Inclusion BF</span></span>
<span><span class="co">#&gt; Effect           1/2       0.500       0.747        2.945</span></span>
<span><span class="co">#&gt; Heterogeneity    2/2       1.000       1.000          Inf</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model-averaged estimates:</span></span>
<span><span class="co">#&gt;        Mean Median 0.025 0.975</span></span>
<span><span class="co">#&gt; delta 0.543  0.546 0.000 1.434</span></span>
<span><span class="co">#&gt; rho   0.685  0.694 0.460 0.856</span></span></code></pre></div>
<p>We can again receive the individual model estimates. The <code>Prior rho</code> column now contains a beta distribution rather than spike at zero. This indicates that we used the models assuming differences in variances.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_10</span>, type <span class="op">=</span> <span class="st">"models"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; RoBTT(x1 = fertilization$Self, x2 = fertilization$Crossed, prior_delta = prior("cauchy", </span></span>
<span><span class="co">#&gt;     list(0, 1/sqrt(2))), prior_rho = prior("beta", list(3, 3)), </span></span>
<span><span class="co">#&gt;     prior_rho_null = NULL, likelihood = "normal", parallel = TRUE, </span></span>
<span><span class="co">#&gt;     seed = 0)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Robust Bayesian t-test</span></span>
<span><span class="co">#&gt; Models overview:</span></span>
<span><span class="co">#&gt;  Model Distribution   Prior delta    Prior rho Prior prob. log(marglik)</span></span>
<span><span class="co">#&gt;      1       normal        Spike(0) Beta(3, 3)       0.500       -75.96</span></span>
<span><span class="co">#&gt;      2       normal Cauchy(0, 0.71) Beta(3, 3)       0.500       -74.88</span></span>
<span><span class="co">#&gt;  Post. prob. Inclusion BF</span></span>
<span><span class="co">#&gt;        0.253        0.340</span></span>
<span><span class="co">#&gt;        0.747        2.945</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="model-averaging-over-equal-and-unequal-variances">Model-Averaging Over Equal and Unequal Variances<a class="anchor" aria-label="anchor" href="#model-averaging-over-equal-and-unequal-variances"></a>
</h2>
<p>The benefit of RoBTT in comparison to other commonly used <span class="math inline">\(t\)</span>-tests is that it does not require us to rely on a single model but instead allows researchers to take different models into account at the same time. In other words, RoBTT uses Bayesian model-averaging to allow the data to guide the inference to be based most strongly on those models that predicted the data best. We can fit a <span class="math inline">\(t\)</span>-test that model-averages over equal and unequal variances with the code provided below.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fit t-test model averaging over equal and unequal variances</span></span>
<span><span class="va">fit_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RoBTT.html">RoBTT</a></span><span class="op">(</span></span>
<span>  x1       <span class="op">=</span> <span class="va">fertilization</span><span class="op">$</span><span class="va">Self</span>,</span>
<span>  x2       <span class="op">=</span> <span class="va">fertilization</span><span class="op">$</span><span class="va">Crossed</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  prior_delta <span class="op">=</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span><span class="st">"cauchy"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  prior_rho   <span class="op">=</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span><span class="st">"beta"</span>,   <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  likelihood  <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>  seed        <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We retrieve the overall estimates as before using the summary function.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; RoBTT(x1 = fertilization$Self, x2 = fertilization$Crossed, prior_delta = prior("cauchy", </span></span>
<span><span class="co">#&gt;     list(0, 1/sqrt(2))), prior_rho = prior("beta", list(3, 3)), </span></span>
<span><span class="co">#&gt;     likelihood = "normal", parallel = FALSE, seed = 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Robust Bayesian t-test</span></span>
<span><span class="co">#&gt; Components summary:</span></span>
<span><span class="co">#&gt;               Models Prior prob. Post. prob. Inclusion BF</span></span>
<span><span class="co">#&gt; Effect           2/4       0.500       0.745        2.929</span></span>
<span><span class="co">#&gt; Heterogeneity    2/4       0.500       0.705        2.392</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model-averaged estimates:</span></span>
<span><span class="co">#&gt;        Mean Median 0.025 0.975</span></span>
<span><span class="co">#&gt; delta 0.537  0.549 0.000 1.407</span></span>
<span><span class="co">#&gt; rho   0.628  0.632 0.476 0.842</span></span></code></pre></div>
<p>When looking at the individual models, we see that four models (instead of two) are incorporated. These are the two equal variance models (from the first test in this vignette) and the two unequal variance models (from the second test in this vignette). The inclusion Bayes factors tell us the evidence for each of these individual models. We see that the model assuming an effect and unequal variances has the highest predictive accuracy.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_1</span>, type <span class="op">=</span> <span class="st">"models"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; RoBTT(x1 = fertilization$Self, x2 = fertilization$Crossed, prior_delta = prior("cauchy", </span></span>
<span><span class="co">#&gt;     list(0, 1/sqrt(2))), prior_rho = prior("beta", list(3, 3)), </span></span>
<span><span class="co">#&gt;     likelihood = "normal", parallel = FALSE, seed = 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Robust Bayesian t-test</span></span>
<span><span class="co">#&gt; Models overview:</span></span>
<span><span class="co">#&gt;  Model Distribution   Prior delta    Prior rho Prior prob. log(marglik)</span></span>
<span><span class="co">#&gt;      1       normal        Spike(0) Spike(0.5)       0.250       -76.82</span></span>
<span><span class="co">#&gt;      2       normal        Spike(0) Beta(3, 3)       0.250       -75.96</span></span>
<span><span class="co">#&gt;      3       normal Cauchy(0, 0.71) Spike(0.5)       0.250       -75.76</span></span>
<span><span class="co">#&gt;      4       normal Cauchy(0, 0.71) Beta(3, 3)       0.250       -74.88</span></span>
<span><span class="co">#&gt;  Post. prob. Inclusion BF</span></span>
<span><span class="co">#&gt;        0.076        0.245</span></span>
<span><span class="co">#&gt;        0.179        0.654</span></span>
<span><span class="co">#&gt;        0.219        0.842</span></span>
<span><span class="co">#&gt;        0.526        3.332</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="model-averaging-over-robust-t-likelihoods">Model-Averaging Over Robust t-likelihoods<a class="anchor" aria-label="anchor" href="#model-averaging-over-robust-t-likelihoods"></a>
</h2>
<p>A common problem for t-tests that assume the normality of residuals is outliers. When outliers are present, the estimates of these methods can be driven overly strongly by those outliers. A common way to accomodate outliers is by also model-averaging over robust <span class="math inline">\(t\)</span>-likelihoods. The t-distribution has thicker tails than the normal distribution; therefore, the estimate under the <span class="math inline">\(t\)</span>-likelihood will be affected less due to outliers than the estimate using a normal likelihood. We can fit RoBTT that also model-averages over <span class="math inline">\(t\)</span>-likelihoods as follows.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RoBTT.html">RoBTT</a></span><span class="op">(</span></span>
<span>  x1       <span class="op">=</span> <span class="va">fertilization</span><span class="op">$</span><span class="va">Self</span>,</span>
<span>  x2       <span class="op">=</span> <span class="va">fertilization</span><span class="op">$</span><span class="va">Crossed</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  prior_delta <span class="op">=</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span><span class="st">"cauchy"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  prior_rho   <span class="op">=</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span><span class="st">"beta"</span>,   <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  prior_nu    <span class="op">=</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span><span class="st">"exp"</span>,    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="co"># prior on degrees of freedom + 2</span></span>
<span>  likelihood  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"normal"</span>, <span class="st">"t"</span><span class="op">)</span>, <span class="co"># use both normal and t-likelihoods</span></span>
<span>  seed        <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>When looking at the individual model estimates incorporating <span class="math inline">\(t\)</span>-likelihoods, we find that the four models from the previous t-test are incorporated a second time, however, with t-likelihood in the likelihood column. In other words, we now use eight models overall.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_2</span>, type <span class="op">=</span> <span class="st">"models"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; RoBTT(x1 = fertilization$Self, x2 = fertilization$Crossed, prior_delta = prior("cauchy", </span></span>
<span><span class="co">#&gt;     list(0, 1/sqrt(2))), prior_rho = prior("beta", list(3, 3)), </span></span>
<span><span class="co">#&gt;     prior_nu = prior("exp", list(1)), likelihood = c("normal", </span></span>
<span><span class="co">#&gt;         "t"), parallel = TRUE, seed = 2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Robust Bayesian t-test</span></span>
<span><span class="co">#&gt; Models overview:</span></span>
<span><span class="co">#&gt;  Model Distribution   Prior delta    Prior rho    Prior nu    Prior prob.</span></span>
<span><span class="co">#&gt;      1       normal        Spike(0) Spike(0.5)                      0.125</span></span>
<span><span class="co">#&gt;      2            t        Spike(0) Spike(0.5) Exponential(1)       0.125</span></span>
<span><span class="co">#&gt;      3       normal        Spike(0) Beta(3, 3)                      0.125</span></span>
<span><span class="co">#&gt;      4            t        Spike(0) Beta(3, 3) Exponential(1)       0.125</span></span>
<span><span class="co">#&gt;      5       normal Cauchy(0, 0.71) Spike(0.5)                      0.125</span></span>
<span><span class="co">#&gt;      6            t Cauchy(0, 0.71) Spike(0.5) Exponential(1)       0.125</span></span>
<span><span class="co">#&gt;      7       normal Cauchy(0, 0.71) Beta(3, 3)                      0.125</span></span>
<span><span class="co">#&gt;      8            t Cauchy(0, 0.71) Beta(3, 3) Exponential(1)       0.125</span></span>
<span><span class="co">#&gt;  log(marglik) Post. prob. Inclusion BF</span></span>
<span><span class="co">#&gt;        -76.82       0.006        0.042</span></span>
<span><span class="co">#&gt;        -77.79       0.002        0.016</span></span>
<span><span class="co">#&gt;        -75.96       0.014        0.100</span></span>
<span><span class="co">#&gt;        -77.33       0.004        0.025</span></span>
<span><span class="co">#&gt;        -75.76       0.017        0.123</span></span>
<span><span class="co">#&gt;        -72.34       0.526        7.758</span></span>
<span><span class="co">#&gt;        -74.88       0.042        0.303</span></span>
<span><span class="co">#&gt;        -72.64       0.390        4.468</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">Model (8): Minimum effective sample size was low (244).</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="perinull-testing">Perinull testing<a class="anchor" aria-label="anchor" href="#perinull-testing"></a>
</h2>
<p>It is sometimes argued that point null hypotheses are not meaningful to test as evidence for the alternative could already be provided by deviations from the null that would be considered small or uninteresting. RoBTT addresses this concern by allowing researchers to specify perinull hypotheses (i.e., a prior distribution with small sd instead of the point null).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RoBTT.html">RoBTT</a></span><span class="op">(</span></span>
<span>  x1       <span class="op">=</span> <span class="va">fertilization</span><span class="op">$</span><span class="va">Self</span>,</span>
<span>  x2       <span class="op">=</span> <span class="va">fertilization</span><span class="op">$</span><span class="va">Crossed</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  prior_delta      <span class="op">=</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span><span class="st">"cauchy"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  prior_rho        <span class="op">=</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span><span class="st">"beta"</span>,   <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  prior_nu         <span class="op">=</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span><span class="st">"exp"</span>,    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  prior_delta_null <span class="op">=</span> <span class="fu"><a href="../reference/prior.html">prior</a></span><span class="op">(</span><span class="st">"normal"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.15</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span>, <span class="co"># prior distribution and truncation</span></span>
<span>  likelihood       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"normal"</span>, <span class="st">"t"</span><span class="op">)</span>,</span>
<span>  seed             <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>When looking at the individual models we see that the models that previously had Spike(0.5) are now using normal(0, 0.15) prior from 0 to infinity. This indicates the shift from point null to perinull testing.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_3</span>, type <span class="op">=</span> <span class="st">"models"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; RoBTT(x1 = fertilization$Self, x2 = fertilization$Crossed, prior_delta = prior("cauchy", </span></span>
<span><span class="co">#&gt;     list(0, 1/sqrt(2)), list(0, Inf)), prior_rho = prior("beta", </span></span>
<span><span class="co">#&gt;     list(3, 3)), prior_nu = prior("exp", list(1)), prior_delta_null = prior("normal", </span></span>
<span><span class="co">#&gt;     list(0, 0.15), list(0, Inf)), likelihood = c("normal", "t"), </span></span>
<span><span class="co">#&gt;     parallel = TRUE, seed = 3)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Robust Bayesian t-test</span></span>
<span><span class="co">#&gt; Models overview:</span></span>
<span><span class="co">#&gt;  Model Distribution       Prior delta        Prior rho    Prior nu   </span></span>
<span><span class="co">#&gt;      1       normal Normal(0, 0.15)[0, Inf] Spike(0.5)               </span></span>
<span><span class="co">#&gt;      2            t Normal(0, 0.15)[0, Inf] Spike(0.5) Exponential(1)</span></span>
<span><span class="co">#&gt;      3       normal Normal(0, 0.15)[0, Inf] Beta(3, 3)               </span></span>
<span><span class="co">#&gt;      4            t Normal(0, 0.15)[0, Inf] Beta(3, 3) Exponential(1)</span></span>
<span><span class="co">#&gt;      5       normal Cauchy(0, 0.71)[0, Inf] Spike(0.5)               </span></span>
<span><span class="co">#&gt;      6            t Cauchy(0, 0.71)[0, Inf] Spike(0.5) Exponential(1)</span></span>
<span><span class="co">#&gt;      7       normal Cauchy(0, 0.71)[0, Inf] Beta(3, 3)               </span></span>
<span><span class="co">#&gt;      8            t Cauchy(0, 0.71)[0, Inf] Beta(3, 3) Exponential(1)</span></span>
<span><span class="co">#&gt;  Prior prob. log(marglik) Post. prob. Inclusion BF</span></span>
<span><span class="co">#&gt;        0.125       -76.07       0.006        0.040</span></span>
<span><span class="co">#&gt;        0.125       -73.77       0.057        0.423</span></span>
<span><span class="co">#&gt;        0.125       -75.19       0.014        0.097</span></span>
<span><span class="co">#&gt;        0.125       -73.92       0.049        0.359</span></span>
<span><span class="co">#&gt;        0.125       -75.10       0.015        0.107</span></span>
<span><span class="co">#&gt;        0.125       -71.65       0.473        6.287</span></span>
<span><span class="co">#&gt;        0.125       -74.21       0.037        0.267</span></span>
<span><span class="co">#&gt;        0.125       -71.95       0.350        3.767</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="conclusions">Conclusions<a class="anchor" aria-label="anchor" href="#conclusions"></a>
</h2>
<p>This vignette showcased the applications of the RoBTT R package. For methodological background see the corresponding preprint (ref to preprint TBA).</p>
<div class="section level3 unnumbered">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references">
<div id="ref-fisher1937design">
<p>Fisher, R. A. (1971). <em>The design of experiments</em>. Oliver &amp; Boyd, Edinburgh &amp; London.</p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by František Bartoš, Maximilian Maier.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
